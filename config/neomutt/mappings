# vim: filetype=muttrc

#
# Unbinds
#

bind index,pager '#' noop
bind index,pager '!' noop
bind index,pager b noop
bind index,pager d noop
bind index,pager D noop
bind index,pager \ed noop
bind index,pager \Cd noop
bind index,pager \CD noop
bind index,pager e noop
bind index,pager p noop
bind index,pager o noop
bind index,pager O noop
bind index,pager '$' noop
bind index,pager O noop

bind index,pager h noop
bind pager j noop
bind pager k noop
bind pager l noop
bind index,pager H noop
bind index,pager L noop

bind index,pager g noop
bind index f noop

#
# Index / Pager
#

# Avoid escaping all the way out
bind index q noop
bind index Q noop
bind index x noop
bind index X noop
macro index Q "<sync-mailbox><exit>" "sync & exit"
bind index X exit

bind index,pager <tab> sync-mailbox
macro index,pager S '<shell-escape>mbsync -a; notmuch new<enter>' 'sync email'
macro index f "<enter-command>unset wait_key<enter><shell-escape>read -p 'Search with notmuch: ' x; echo \$x >~/.cache/mutt_terms<enter><limit>~i \"\`notmuch search --output=messages \$(cat ~/.cache/mutt_terms) | head -n 600 | perl -le '@a=<>;s/\^id:// for@a;$,=\"|\";print@a' | perl -le '@a=<>; chomp@a; s/\\+/\\\\+/ for@a;print@a' \`\"<enter>" "search with notmuch"
macro index // '<vfolder-from-query>'
bind index,pager '!' flag-message
bind index,pager D delete-message
bind index,pager '@' compose-to-sender
bind index,pager F forward-message
bind index,pager r reply
bind index,pager R group-reply
bind index,pager L edit-label
bind index,pager C mail
bind index,pager M mail
bind index <space> collapse-thread
bind index,pager o change-folder
bind index,pager O change-folder-readonly

bind index gg first-entry
bind index G last-entry
bind pager gg top
bind pager G bottom

bind pager N noop
macro pager N ":set resolve=no\n<set-flag>N:set resolve=yes\n" "mark unread without resolving"

bind pager V noop
macro index,pager V "<view-attachments><search>html<enter><view-mailcap><exit>" "view html"

#
# Misc
#

bind attach <space> view-mailcap

#
# Sidebar
#

bind index,pager <left> sidebar-toggle-visible
bind index,pager <down> sidebar-next
bind index,pager <up> sidebar-prev
bind index,pager <right> sidebar-open

#
# Changing Folders
#

macro index gi '<change-folder>=Inbox<enter>' 'go to inbox'
macro index gs '<change-folder>=[Gmail]/Sent Mail<enter>' 'go to sent mail'
macro index gd '<change-folder>=[Gmail]/Drafts<enter>' 'go to drafts'
macro index gI '<change-folder>Important<enter>' 'go to important'
macro index gU '<change-folder>Unread<enter>' 'go to Unread'

#
# Scrolling
#

bind attach,browser,pager,index \CF next-page
bind attach,browser,pager,index \CB previous-page
bind attach,browser,pager,index \Cu half-up
bind attach,browser,pager,index \Cd half-down
bind browser,pager              \Ce next-line
bind browser,pager              \Cy previous-line
bind index                      \Ce next-line
bind index                      \Cy previous-line
bind browser,pager              j next-line
bind browser,pager              k previous-line
bind browser,pager              <down> next-line
bind browser,pager              <up> previous-line
